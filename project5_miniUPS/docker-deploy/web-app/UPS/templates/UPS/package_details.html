<!DOCTYPE html>
<html>

<head>
    <title>Package Details</title>
</head>

<body>
    <h2>Package Details</h2>
    <p>Tracking Number: {{ tracking_number }}</p>
    <p>Status: {{ status }}</p>
    <p>Destination Address: x = {{ dest_addr_x }}, y = {{ dest_addr_y }}</p>

    {% if status == "at warehouse" %}
    <form method="post">
        {% csrf_token %}
        <button type="button" onclick="toggleEdit()">Edit Address</button>
        <div id="edit-address" style="display: none;">
            <div>
                <label for="new_addr_x">New X:</label>
                <input type="number" id="new_addr_x" name="new_addr_x" step="1">
            </div>
            <div>
                <label for="new_addr_y">New Y:</label>
                <input type="number" id="new_addr_y" name="new_addr_y" step="1">
            </div>
            <button type="submit">Save</button>
        </div>
    </form>
    {% elif status == "loading" %}
    <form method="post">
        {% csrf_token %}
        <button type="button" onclick="toggleEdit()">Edit Address</button>
        <div id="edit-address" style="display: none;">
            <div>
                <label for="new_addr_x">New X:</label>
                <input type="number" id="new_addr_x" name="new_addr_x" step="1">
            </div>
            <div>
                <label for="new_addr_y">New Y:</label>
                <input type="number" id="new_addr_y" name="new_addr_y" step="1">
            </div>
            <button type="submit">Save</button>
        </div>
    </form>
    {% elif status == "delivering" %}
    <button type="button" onclick="showMessage()">Edit Address</button>
    <p id="edit-message" style="display: none;">This package is out for delivery. You cannot edit the delivery address.
    </p>
    {% elif status == "delivered" %}
    <button type="button" onclick="showMessage()">Edit Address</button>
    <p id="edit-message" style="display: none;">This package has been delivered. You cannot edit the delivery address.
    </p>
    {% endif %}

    <script>
        function toggleEdit() {
            var x = document.getElementById("edit-address");
            if (x.style.display === "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        }

        function showMessage() {
            var x = document.getElementById("edit-message");
            if (x.style.display === "none") {
                x.style.display = "block";
            }
        }
    </script>

    <h3>Delivery Information:</h3>
    <ul>
        {% for info in delivery_info %}
        <li>{{ info }}</li>
        {% endfor %}
    </ul>

    <a href="{% url 'myPackages' %}">Back to My Packages</a>

</body>

</html>